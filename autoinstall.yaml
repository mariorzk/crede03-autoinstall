autoinstall:
  version: 1
  locale: pt_BR
  keyboard:
    layout: br
  timezone: America/Fortaleza
  identity:
    hostname: xubuntu-cr03
    realname: "Administrador"
    username: administrador
    password: "$6$LzWZ5GpNYeWUSQS2$Q27nW8WrDtmSXxymEqi/8VvgZ7pSGvNtgxX3dhDsfAbhQpOZoO76ZVgcqvDR5J1Ep9hOgM.g/sH6Kt8tWJ.pT."
  storage:
    layout:
      name: direct
  user-data:
    users:
      - name: aluno
        gecos: Aluno
        shell: /bin/bash
        primary_group: users
        groups: [users]
        lock_passwd: false
        passwd: "$6$ERVS1XMCn/pLbSer$KFvofTI4vzJlWuVVdiPkikGcQG2GuBNvX1E/yCf8dMAOYyvpvAAQBqqbUd4HtDpI50xTKk5yZmublNZLl/sy9/"
        sudo: ""
        system: false
        no_create_home: false
        ssh_import_id: []
        ssh_authorized_keys: []
        uid: 1001
        home: /home/aluno
  packages:
    - openssh-server
    - firefox
    - firefox-locale-pt
    - google-chrome-stable
    - anydesk
    - gnome-disk-utility
    - libxdo3
    - epoptes-client
  codecs:
    install: true
  drivers:
    install: true
  late-commands:
    - echo "autologin-user=aluno" >> /target/etc/lightdm/lightdm.conf
    - echo "autologin-timeout=0" >> /target/etc/lightdm/lightdm.conf
    - curtin in-target --target=/target sh -c 'wget -O /tmp/rustdesk.deb https://github.com/rustdesk/rustdesk/releases/download/1.4.0/rustdesk-1.4.0-x86_64.deb && apt install -y /tmp/rustdesk.deb'
    - curtin in-target --target=/target mkdir -p /etc/skel/.config/xfce4/xfconf/xfce-perchannel-xml
    - curtin in-target --target=/target sh -c "cat > /etc/skel/.config/xfce4/xfconf/xfce-perchannel-xml/xfce4-power-manager.xml <<EOF
<?xml version=\"1.0\" encoding=\"UTF-8\"?>
<channel name=\"xfce4-power-manager\" version=\"1.0\">
  <property name=\"xfce4-power-manager\" type=\"empty\">
    <property name=\"power-button-action\" type=\"empty\"/> 
    <property name=\"lock-screen-suspend-hibernate\" type=\"bool\" value=\"false\"/>
    <property name=\"logind-handle-lid-switch\" type=\"empty\"/>
    <property name=\"blank-on-ac\" type=\"int\" value=\"0\"/>
    <property name=\"blank-on-battery\" type=\"empty\"/>
    <property name=\"dpms-enabled\" type=\"bool\" value=\"false\"/>
    <property name=\"dpms-on-ac-sleep\" type=\"uint\" value=\"0\"/>
    <property name=\"dpms-on-ac-off\" type=\"uint\" value=\"0\"/>
    <property name=\"dpms-on-battery-sleep\" type=\"empty\"/>
    <property name=\"dpms-on-battery-off\" type=\"empty\"/>
    <property name=\"show-panel-label\" type=\"empty\"/>
    <property name=\"inactivity-sleep-mode-on-ac\" type=\"empty\"/>
    <property name=\"inactivity-sleep-mode-on-battery\" type=\"empty\"/>
    <property name=\"show-tray-icon\" type=\"bool\" value=\"false\"/>
  </property>
</channel>
EOF"
    - curtin in-target --target=/target sh -c "cat > /etc/skel/.config/xfce4/xfconf/xfce-perchannel-xml/xfce4-screensaver.xml <<EOF
<?xml version=\"1.0\" encoding=\"UTF-8\"?>
<channel name=\"xfce4-screensaver\" version=\"1.0\">
  <property name=\"saver\" type=\"empty\">
    <property name=\"mode\" type=\"int\" value=\"0\"/>
    <property name=\"idle-activation\" type=\"empty\">
      <property name=\"enabled\" type=\"bool\" value=\"false\"/>
    </property>
    <property name=\"enabled\" type=\"bool\" value=\"false\"/>
  </property>  
  <property name=\"lock\" type=\"empty\">    
    <property name=\"user-switching\" type=\"empty\">      
      <property name=\"enabled\" type=\"bool\" value=\"false\"/>
    </property>
    <property name=\"status-messages\" type=\"empty\">
      <property name=\"enabled\" type=\"bool\" value=\"false\"/>
    </property>
    <property name=\"sleep-activation\" type=\"bool\" value=\"false\"/>
    <property name=\"saver-activation\" type=\"empty\">
      <property name=\"enabled\" type=\"bool\" value=\"false\"/>
    </property>
    <property name=\"enabled\" type=\"bool\" value=\"false\"/>
  </property>
</channel>
EOF"
    - curtin in-target --target=/target mkdir -p /home/aluno/.config/rustdesk
    - curtin in-target --target=/target sh -c "cat > /home/aluno/.config/rustdesk/RustDesk.toml <<EOF
password = '00FUCiscH4GEf27ecLxNIAZio+e+p5pMSY'
EOF"
    - curtin in-target --target=/target chown -R aluno:aluno /home/aluno/.config
    - curtin in-target --target=/target sh -c 'apt-get remove --purge -y gnome-keyring'
