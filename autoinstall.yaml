autoinstall:
  version: 1
  locale: pt_BR
  keyboard:
    layout: br
    variant: abnt2
  timezone: America/Fortaleza
  identity:
    hostname: xubuntu-cr03
    username: administrador
    password: "$6$kP3QkL2x$QU3PpiE5L4IOGhd2XLW1b7sy9Xr9TyzsxUQxRNgqOX5PQUvaTOHtBl/FPZJXyd0a6twFPrDa9gOaBfD6CNvIj."
  users:
    - name: administrador
      gecos: Administrador
      shell: /bin/bash
      primary_group: adm
      groups: [adm, sudo]
      lock_passwd: false
      passwd: "$6$kP3QkL2x$QU3PpiE5L4IOGhd2XLW1b7sy9Xr9TyzsxUQxRNgqOX5PQUvaTOHtBl/FPZJXyd0a6twFPrDa9gOaBfD6CNvIj."
    - name: aluno
      gecos: Aluno
      shell: /bin/bash
      primary_group: users
      groups: [users]
      lock_passwd: false
      passwd: "$6$rTkA7uLh$GZNR6JvUnsnD4czKPIHv1eFSQniSzxuG4Xn2fr3FwAOir9WjDCkvo8GEKDqypYuN/zcfEFxFTOSYYw3h2GFVs1"

  storage:
    layout:
      name: direct

  packages:
    - epoptes-client
    - openssh-server
    - google-chrome-stable
    - firefox
    - firefox-locale-pt

  codecs:
    install: true

  drivers:
    install: true

  late-commands:
    - curtin in-target --target=/target apt update
    - curtin in-target --target=/target apt install -y anydesk
    - curtin in-target --target=/target apt remove --purge -y gnome-keyring
    - curtin in-target --target=/target wget -qO /tmp/rustdesk.deb https://github.com/rustdesk/rustdesk/releases/download/1.4.0/rustdesk-1.4.0-x86_64.deb
    - curtin in-target --target=/target apt install -y /tmp/rustdesk.deb
    - curtin in-target --target=/target apt update
    - curtin in-target --target=/target apt install -y gnome-disk-utility

    - curtin in-target --target=/target mkdir -p /home/aluno/.config/xfce4/xfconf/xfce-perchannel-xml
    - curtin in-target --target=/target bash -c 'cat > /home/aluno/.config/xfce4/xfconf/xfce-perchannel-xml/xfce4-power-manager.xml <<EOF
<?xml version="1.0" encoding="UTF-8"?>
<channel name="xfce4-power-manager" version="1.0">
  <property name="blank-on-ac" type="int" value="0"/>
  <property name="dpms-enabled" type="bool" value="false"/>
  <property name="inactivity-sleep-mode-on-ac" type="uint" value="0"/>
</channel>
EOF'

    - curtin in-target --target=/target bash -c 'cat > /home/aluno/.config/xfce4/xfconf/xfce-perchannel-xml/xfce4-screensaver.xml <<EOF
<?xml version="1.0" encoding="UTF-8"?>
<channel name="xfce4-screensaver" version="1.0">
  <property name="enabled" type="bool" value="false"/>
</channel>
EOF'

    - curtin in-target --target=/target chown -R aluno:aluno /home/aluno/.config

  shutdown: reboot
