autoinstall:
  version: 1
  locale: pt_BR
  keyboard:
    layout: br
  timezone: America/Fortaleza
  # user-data:
  #   users:
  #     - name: administrador
  #       gecos: Administrador
  #       shell: /bin/bash
  #       primary_group: adm
  #       groups: [adm, sudo]
  #       lock_passwd: false
  #       passwd: "*Sup0rt3@CR3D3"

  #     - name: aluno
  #       gecos: Aluno
  #       shell: /bin/bash
  #       primary_group: users
  #       groups: [users]
  #       lock_passwd: false
  #       passwd: "aluno"
  storage:
    layout:
      name: direct
  packages:
    - epoptes-client
    - openssh-server
    - google-chrome-stable
    - firefox
    - firefox-locale-pt
  codecs:
    install: true
  drivers:
    install: true
  late-commands:
    - curtin in-target --target=/target apt update
    - curtin in-target --target=/target apt install -y anydesk
    - curtin in-target --target=/target apt remove --purge -y gnome-keyring
    - curtin in-target --target=/target wget -qO /tmp/rustdesk.deb https://github.com/rustdesk/rustdesk/releases/download/1.4.0/rustdesk-1.4.0-x86_64.deb
    - curtin in-target --target=/target apt install -y /tmp/rustdesk.deb
    - curtin in-target --target=/target apt install -y gnome-disk-utility

    - curtin in-target --target=/target mkdir -p /home/aluno/.config/xfce4/xfconf/xfce-perchannel-xml
    - curtin in-target --target=/target mkdir -p /home/aluno/.config/rustdesk    
    
    - echo "[Seat:*]" > /target/etc/lightdm/lightdm.conf.d/99-autologin.conf
    - echo "autologin-user=aluno" >> /target/etc/lightdm/lightdm.conf.d/99-autologin.conf

    - curtin in-target --target=/target bash -c 'cat > /home/aluno/.config/xfce4/xfconf/xfce-perchannel-xml/xfce4-power-manager.xml <<EOF <?xml version="1.0" encoding="UTF-8"?><channel name="xfce4-power-manager" version="1.0">  <property name="blank-on-ac" type="int" value="0"/>  <property name="dpms-enabled" type="bool" value="false"/>  <property name="inactivity-sleep-mode-on-ac" type="uint" value="0"/></channel> EOF'
    - curtin in-target --target=/target bash -c 'cat > /home/aluno/.config/xfce4/xfconf/xfce-perchannel-xml/xfce4-screensaver.xml <<EOF <?xml version="1.0" encoding="UTF-8"?><channel name="xfce4-screensaver" version="1.0">  <property name="enabled" type="bool" value="false"/></channel> EOF'
    - curtin in-target --target=/target bash -c 'cat > /home/aluno/.config/rustdesk/RustDesk.toml <<EOF password = '@master;' EOF'
    - curtin in-target --target=/target chown -R aluno:aluno /home/aluno/.config
